/**
 * vAccordion - AngularJS multi-level accordion component
 * @version v0.0.3
 * @link http://lukaszwatroba.github.io/v-accordion
 * @author Łukasz Wątroba <l@lukaszwatroba.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */

!function(e){"use strict";function n(n){var t=this;n.isDisabled=!1,n.panes=[];var o=function(){for(var e=!1,t=0,o=n.panes.length;o>t;t++){var a=n.panes[t];if(a.isExpanded){e=!0;break}}return e};t.addPane=function(e){if(!n.allowMultiple&&o()&&e.isExpanded)throw new Error("The allow-multiple attribute is not set");n.panes.push(e)},t.disable=function(){n.isDisabled=!0},t.enable=function(){n.isDisabled=!1},t.expandAll=function(){if(!n.isDisabled){if(!n.allowMultiple)throw new Error("The attribute allow-multiple is not set");e.forEach(n.panes,function(e){e.isExpanded=!0})}},t.collapseAll=function(t){n.isDisabled||e.forEach(n.panes,function(e){e!==t&&(e.isExpanded=!1)})},t.toggle=function(e){!n.isDisabled&&e&&(n.allowMultiple||t.collapseAll(e),e.isExpanded=!e.isExpanded)},t.expand=function(e){!n.isDisabled&&e&&(n.allowMultiple||t.collapseAll(e),e.isExpanded=!0)},t.collapse=function(e){!n.isDisabled&&e&&(e.isExpanded=!1)},n.internalControl={toggle:function(e){var o=n.panes[e];t.toggle(o)},expand:function(e){var o=n.panes[e];t.expand(o)},collapse:function(e){var o=n.panes[e];t.collapse(o)},expandAll:t.expandAll,collapseAll:t.collapseAll}}function t(e){var n=this;n.toggle=function(){e.isAnimating||e.accordionCtrl.toggle(e)}}function o(n){return{restrict:"EA",replace:!0,transclude:!0,template:"<div ng-transclude></div>",scope:{control:"=?",allowMultiple:"=?"},controllerAs:"accordionCtrl",controller:"vAccordionController",compile:function(t){return t.addClass(n.classes.accordion),function(n,t,o){e.isDefined(n.allowMultiple)||(n.allowMultiple=e.isDefined(o.allowMultiple)),n.control=n.internalControl}}}}function a(n,t,o){return{restrict:"EA",require:"^vAccordion",transclude:!0,replace:!0,template:"<div ng-transclude></div>",scope:{isExpanded:"=?expanded"},controllerAs:"paneCtrl",controller:"vPaneController",compile:function(a){return a.addClass(o.classes.pane),function(a,i,l,c){function r(){c.disable();var e=u.offsetHeight;p.style.maxHeight="0px",t.addClass(v,o.classes.expandedState).then(function(){c.enable(),p.style.maxHeight="none"}),setTimeout(function(){p.style.maxHeight=e+"px"},0),i.addClass(o.classes.expandedState),f.addClass(o.classes.expandedState)}function s(){c.disable();var e=u.offsetHeight;p.style.maxHeight=e+"px",t.removeClass(v,o.classes.expandedState).then(function(){c.enable()}),setTimeout(function(){p.style.maxHeight="0px"},0),i.removeClass(o.classes.expandedState),f.removeClass(o.classes.expandedState)}e.isDefined(a.isExpanded)||(a.isExpanded=e.isDefined(l.expanded));var d=i[0].querySelector("."+o.classes.paneHeader),p=i[0].querySelector("."+o.classes.paneContent);if(!d)throw new Error("v-pane-header not found");if(!p)throw new Error("v-pane-content not found");var u=p.querySelector("div"),f=e.element(d),v=e.element(p);c.addPane(a),a.accordionCtrl=c,p.style.maxHeight="0px",n(function(){a.isExpanded&&r()},100),a.$watch("isExpanded",function(e,n){return e===n?!0:(e?r():s(),void 0)})}}}}function i(e){return{restrict:"EA",require:"^vPane",transclude:!0,replace:!0,template:'<div ng-click="paneCtrl.toggle()"><div ng-transclude></div></div>',scope:{},compile:function(n){return n.addClass(e.classes.paneHeader),function(e,n,t,o){e.paneCtrl=o}}}}function l(e){return{restrict:"EA",require:"^vPane",transclude:!0,replace:!0,template:"<div><div ng-transclude></div></div>",scope:{},compile:function(n){return n.addClass(e.classes.paneContent),function(e,n,t,o){e.paneCtrl=o}}}}e.module("vAccordion",["ngAnimate","vAccordion.config","vAccordion.controllers","vAccordion.directives"]),e.module("vAccordion.config",[]).constant("accordionConfig",{classes:{accordion:"Accordion Accordion--dafault",pane:"Accordion-pane",paneHeader:"Accordion-paneHeader",paneContent:"Accordion-paneContent",expandedState:"is-expanded"}}),e.module("vAccordion.controllers",[]).controller("vAccordionController",n).controller("vPaneController",t),n.$inject=["$scope"],t.$inject=["$scope"],e.module("vAccordion.directives",[]).directive("vAccordion",o).directive("vPane",a).directive("vPaneHeader",i).directive("vPaneContent",l),o.$inject=["accordionConfig"],a.$inject=["$timeout","$animate","accordionConfig"],i.$inject=["accordionConfig"],l.$inject=["accordionConfig"]}(angular);